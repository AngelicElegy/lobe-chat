# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## 📚 文档索引

项目文档已模块化拆分，便于查找和维护。各模块文档详情如下：

### 🏠 项目基础
**📋 文档**: `@.claude/project-overview.md`

包含内容：
- 项目概述和基本信息
- 开发命令和包管理器
- 技术栈介绍
- 数据库相关配置

### 🏗️ 架构设计
**📋 文档**: `@.claude/architecture.md`

包含内容：
- 完整的目录结构说明
- API 架构设计
- 认证架构
- 双模式架构（Client/Server）
- 特殊注意事项

### 🎯 模块职责规范
**📋 文档**: `@.claude/module-responsibilities.md`

包含内容：
- Database 模块职责和开发规范
- Server/Routers 模块职责和路由分类
- Store 状态管理模块职责
- 各模块的架构设计和开发规范

### ⚙️ 配置指南
**📋 文档**: `@.claude/configuration.md`

包含内容：
- 环境变量配置
- 邮件服务配置（阿里云邮件推送）
- 数据库配置和迁移管理

### 👨‍💻 开发指南
**📋 文档**: `@.claude/development-guide.md`

包含内容：
- 添加新页面流程
- 添加新 API 接口流程
- 状态管理开发
- 样式开发规范

### 🚀 API开发指南
**📋 文档**: `@.claude/api-development-guide.md`

包含内容：
- 完整的8层API开发链路（tRPC路由 → 数据库模型 → 服务层 → 类型定义 → 状态管理 → 工具函数 → 中间件 → 前端Hook）
- 各层职责和规范要求
- 开发顺序建议和代码模板
- 文件命名和目录结构规范
- 双模式架构（Client/Server）实现要点
- 权限控制和错误处理规范

## 🔗 快速导航

### 新手入门
1. 先阅读 **项目基础** 了解项目概况
2. 再阅读 **架构设计** 理解整体架构
3. 查看 **模块职责规范** 了解各模块职责

### 开发需求
- **新增页面**: 查看 **开发指南**
- **新增API**: 查看 **API开发指南**
- **配置问题**: 查看 **配置指南**
- **架构疑问**: 查看 **架构设计** 和 **模块职责规范**

### 开发建议

#### API开发
1. **新增API前必读**: 查阅 **API开发指南** 了解完整实现链路
2. **参考现有实现**: 以 session、message、user 等模块的API实现为模板
3. **遵循命名规范**: 保持代码风格的一致性
4. **编写测试用例**: Model层和Service层必须编写单元测试
5. **权限控制**: 所有敏感操作必须实现RBAC权限校验
6. **错误处理**: 使用TRPCError进行标准化错误处理

#### 一般开发
1. **遵循模块职责**: 严格按照各模块的职责划分进行开发
2. **参考现有代码**: 以现有实现为模板，保持代码一致性
3. **文档更新**: 重要更改需要同步更新相关文档
4. **测试覆盖**: 确保关键功能有完整的测试覆盖

---

*本文档索引将随着项目发展持续更新*
